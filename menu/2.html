<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pesquisar Advogado</title>
<link rel="icon" href="../img/logo.png">
<style>
    body {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        height: 100vh;
        margin: 0;
        background-color: #f0f0f0;
        font-family: Arial, sans-serif;
    }

    #container {
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        text-align: center;
    }
	
	#title {
        margin-top: 10;
        color: black;
		margin: 10px 0;
    }

    h2 {
        margin: 10px 0;
    }

    h2 {
        font-size: 15px;
    }

    ul {
        list-style-type: none;
        padding: 0;
    }

    #result {
        max-height: 200px;
        overflow-y: auto;
        margin-bottom: 10px;
    }

    #developer {
        color: #888;
        font-size: smaller;
    }

    #returnButton {
        margin-top: 20px;
        margin-bottom: 20px;
    }
	
	#logo {
        width: 50px; /* Largura da imagem */
        height: auto; /* Altura ajustada automaticamente de acordo com a largura */
        margin-bottom: 20px; /* Espaçamento abaixo da imagem */
    }
	
</style>
</head>
<body>


<div id="container">
    <a href="../index.html">
        <img id="logo" src="../img/logo.png" alt="J">
    </a>
    <h1 id="title">Pesquisar Advogado</h1>

    <h2>Cole aqui:</h2>
    <textarea id="processList" rows="10" cols="50"></textarea><br>
    <button onclick="extractProcesses()">Extrair Números</button>

    <ul id="result"></ul>

    <p id="count"></p>
    <button id="copyButton" style="display:none;" onclick="copyNumbers()">Copiar Números</button>

    <p id="developer">Desenvolvido por Jacson Costa Neves</p>
</div>

<script>
function extractProcesses() {
    var processList = document.getElementById('processList').value;
    var startIndex = processList.indexOf("Entregando documentos Encaminhados");
    if (startIndex === -1) {
        var processes = processList.match(/\b\d{1}\.\d{4}\.\d{2}\.\d{3}\.\d{3}-\d{1}\/\d{3}\b/g);

        var resultDiv = document.getElementById('result');
        resultDiv.innerHTML = '';

        if (processes !== null) {
            var resultUl = document.createElement('ul');

            processes.forEach(function(numeroProcesso) {
                var li = document.createElement('li');
                var button = document.createElement('button');
                button.textContent = numeroProcesso;
                button.onclick = function() {
                    window.open("https://www4.tjmg.jus.br/juridico/sf/proc_partes_advogados2.jsp?listaProcessos=" + numeroProcesso.replace(/\D/g,''));
                };
                li.appendChild(button);
                resultUl.appendChild(li);
            });

            resultDiv.appendChild(resultUl);
        } else {
            var p = document.createElement('p');
            p.textContent = 'Nenhum número de processo encontrado.';
            resultDiv.appendChild(p);
        }
    } else {
        processList = processList.substring(startIndex);
        var processes = processList.match(/\b\d{1}\.\d{4}\.\d{2}\.\d{3}\.\d{3}-\d{1}\/\d{3} - (RP\s+)?HABEAS CORPUS - (CIVEL|CRIMINAL)(?:\s+RP)? -> ([A-Za-z\s]+)/g);
        var processByProcurador = {};
        if (processes !== null) {
            processes.forEach(function(process) {
                var procuradorMatch = process.match(/->\s+([A-Za-z\s]+)/);
                if (procuradorMatch) {
                    var procurador = procuradorMatch[1].trim().replace(/\b(?:DILIG|DEPEND|PREVEN)\b/g, "").trim();
                    var numeroProcesso = process.match(/\b\d{1}\.\d{4}\.\d{2}\.\d{3}\.\d{3}-\d{1}\/\d{3}\b/)[0];
                    if (!processByProcurador[procurador]) {
                        processByProcurador[procurador] = [];
                    }
                    processByProcurador[procurador].push(numeroProcesso);
                }
            });

            var resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '';
            var select = document.createElement('select');

            var optionDefault = new Option('Selecione um procurador', '');
            select.add(optionDefault);

            Object.keys(processByProcurador).forEach(function(procurador) {
                var option = new Option(procurador + ' - ' + processByProcurador[procurador].length + ' processo(s)', procurador);
                select.add(option);
            });

            select.onchange = function() {
                var procuradorSelecionado = select.value;
                var procuradorProcesses = processByProcurador[procuradorSelecionado];
                var resultUl = document.createElement('ul');

                procuradorProcesses.forEach(function(numeroProcesso) {
                    var li = document.createElement('li');
                    var button = document.createElement('button');
                    button.textContent = numeroProcesso;
                    button.onclick = function() {
                        window.open("https://www4.tjmg.jus.br/juridico/sf/proc_partes_advogados2.jsp?listaProcessos=" + numeroProcesso.replace(/\D/g,''));
                    };
                    li.appendChild(button);
                    resultUl.appendChild(li);
                });

                resultDiv.innerHTML = '';
                resultDiv.appendChild(resultUl);

                var countElement = document.getElementById('count');
                countElement.textContent = "Total de processos encontrados para " + procuradorSelecionado + ": " + procuradorProcesses.length;
            };

            resultDiv.appendChild(select);
        } else {
            var resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '';
            var p = document.createElement('p');
            p.textContent = 'Nenhum processo encontrado no formato adequado.';
            resultDiv.appendChild(p);
        }
    }
}
</script>
</body>
</html>
